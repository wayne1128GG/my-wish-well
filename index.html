<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Useless Wishing Fountain</title>
    <style>
        body {
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(to bottom, #87CEEB, #ffffff);
            font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
            overflow: hidden;
            user-select: none;
        }

        #ui-layer {
            position: absolute;
            top: 40px;
            text-align: center;
            z-index: 100;
        }

        .counter-label { font-size: 1.1rem; color: #555; }
        .counter-num { font-size: 3rem; font-weight: bold; color: #2c3e50; text-shadow: 2px 2px 0 white; margin: 2px 0; }
        
        .scores-container {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 5px;
        }

        .score-box {
            font-size: 0.9rem;
            color: #7f8c8d;
            background: rgba(255,255,255,0.6);
            padding: 4px 12px;
            border-radius: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .chance { color: #e74c3c; font-weight: bold; margin-top: 15px; font-size: 0.9rem; }

        #fountain-world {
            position: relative;
            width: 400px;
            height: 300px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
        }

        /* å™´æ³‰çµæ§‹ */
        .tier { background: #e0e0e0; border: 4px solid #bdc3c7; position: relative; display: flex; justify-content: center; }
        .top-bowl { width: 60px; height: 20px; border-radius: 50% 50% 0 0; z-index: 3; }
        .mid-bowl { width: 140px; height: 35px; border-radius: 50% 50% 10px 10px; margin-top: -5px; z-index: 2; }
        .bottom-pool { width: 300px; height: 60px; border-radius: 50% 50% 20px 20px; margin-top: -5px; z-index: 1; overflow: hidden; }
        .pillar { width: 30px; height: 40px; background: #bdc3c7; margin: -5px 0; }
        .water-blue { background: #4faef7; position: absolute; bottom: 5px; width: 90%; height: 60%; border-radius: 50%; opacity: 0.8; box-shadow: 0 0 10px #fff; }

        .spout {
            position: absolute;
            top: -20px;
            width: 4px;
            height: 20px;
            background: rgba(255,255,255,0.8);
            border-radius: 50%;
            animation: waterFlow 1.5s infinite;
        }

        @keyframes waterFlow {
            0% { transform: translateY(0); opacity: 1; }
            50% { transform: translateY(-20px); opacity: 0.5; }
            100% { transform: translateY(0); opacity: 1; }
        }

        .item {
            position: absolute;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            z-index: 50;
            pointer-events: none;
            animation: tossItem 0.8s ease-out forwards;
        }
        
        .coin { background: #f1c40f; border-radius: 50%; border: 2px solid #f39c12; color: #d35400; font-size: 18px; }
        .junk { font-size: 28px; filter: drop-shadow(0 2px 2px rgba(0,0,0,0.2)); }

        @keyframes tossItem {
            0% { transform: translate(0, 0) rotate(0deg); opacity: 1; }
            40% { transform: translate(var(--x), -150px) rotate(180deg); opacity: 1; }
            100% { transform: translate(var(--x), 50px) rotate(360deg); opacity: 0; }
        }

        .splash {
            position: absolute;
            bottom: 50px;
            width: 10px;
            height: 10px;
            background: white;
            border-radius: 50%;
            animation: splashEffect 0.4s ease-out forwards;
            pointer-events: none;
        }

        @keyframes splashEffect {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(4); opacity: 0; }
        }

        .tip { position: fixed; bottom: 20px; color: #7f8c8d; font-size: 0.85rem; text-align: center; padding: 0 20px; line-height: 1.4; }
    </style>
</head>
<body>

    <div id="ui-layer">
        <div class="counter-label" id="label-coins">Current Drops</div>
        <div class="counter-num">ğŸ’° <span id="count">0</span></div>
        
        <div class="scores-container">
            <div class="score-box">ğŸ† <span id="label-best-coin">Best Coins</span>: <span id="best-coin-count">0</span></div>
            <div class="score-box">ğŸ—‘ï¸ <span id="label-best-junk">Best Junk</span>: <span id="best-junk-count">0</span></div>
        </div>
        
        <div class="chance"><span id="label-chance">Success Rate</span>: <span id="chance-val">0.000000</span>%</div>
    </div>

    <div id="fountain-world" onclick="spawnItem(event)">
        <div class="tier top-bowl"><div class="spout"></div></div>
        <div class="pillar"></div>
        <div class="tier mid-bowl"><div class="water-blue"></div></div>
        <div class="pillar"></div>
        <div class="tier bottom-pool">
            <div class="water-blue" style="width: 95%; height: 70%;"></div>
        </div>
    </div>

    <div class="tip" id="label-tip">Click fountain to drop money.<br>Warning: 1% chance of total garbage.</div>

    <script>
        const i18n = {
            'zh-TW': {
                title: "è¶…æ²’ç”¨è¨±é¡˜å™´æ³‰",
                current: "æœ¬æ¬¡æŠ•å…¥",
                bestCoin: "æœ€é«˜ç¡¬å¹£",
                bestJunk: "ç´¯ç©åƒåœ¾",
                chance: "é¡˜æœ›é”æˆç‡",
                tip: "é»æ“Šå™´æ³‰ï¼šéŒ¢é€²å»ï¼Œæ°´å™´å‡ºä¾†ã€‚<br>æ³¨æ„ï¼šæœ‰ 1% çš„æ©Ÿç‡æœƒå™´å‡ºåƒåœ¾ï¼ˆåƒåœ¾æœƒè¢«è¨˜éŒ„ï¼‰ã€‚"
            },
            'en': {
                title: "Useless Wishing Fountain",
                current: "Current Drops",
                bestCoin: "Best Coins",
                bestJunk: "Total Junk",
                chance: "Success Rate",
                tip: "Click fountain to drop money.<br>Warning: 1% chance of total garbage (recorded)."
            }
        };

        const userLang = navigator.language || navigator.userLanguage;
        const lang = userLang.includes('zh') ? 'zh-TW' : 'en';

        document.title = i18n[lang].title;
        document.getElementById('label-coins').innerText = i18n[lang].current;
        document.getElementById('label-best-coin').innerText = i18n[lang].bestCoin;
        document.getElementById('label-best-junk').innerText = i18n[lang].bestJunk;
        document.getElementById('label-chance').innerText = i18n[lang].chance;
        document.getElementById('label-tip').innerHTML = i18n[lang].tip;

        let coinCount = 0;
        let junkCount = parseInt(localStorage.getItem('fountainJunkCount')) || 0;
        let bestCoin = parseInt(localStorage.getItem('fountainBestCoin')) || 0;
        
        const countEl = document.getElementById('count');
        const bestCoinEl = document.getElementById('best-coin-count');
        const bestJunkEl = document.getElementById('best-junk-count');
        const chanceEl = document.getElementById('chance-val');
        const world = document.getElementById('fountain-world');
        
        bestCoinEl.innerText = bestCoin;
        bestJunkEl.innerText = junkCount;

        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playSound(freq, type, duration, volume) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = type;
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            gain.gain.setValueAtTime(volume, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        }

        function spawnItem(e) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            
            coinCount++;
            countEl.innerText = coinCount;
            
            // æ›´æ–°æœ€é«˜ç¡¬å¹£ç´€éŒ„
            if (coinCount > bestCoin) {
                bestCoin = coinCount;
                bestCoinEl.innerText = bestCoin;
                localStorage.setItem('fountainBestCoin', bestCoin);
            }

            let newChance = (50 / (coinCount + 50)).toFixed(6);
            chanceEl.innerText = newChance;

            const isJunk = Math.random() < 0.01;
            const item = document.createElement('div');
            item.className = isJunk ? 'item junk' : 'item coin';
            
            if (isJunk) {
                // å¢åŠ åƒåœ¾ç´€éŒ„
                junkCount++;
                bestJunkEl.innerText = junkCount;
                localStorage.setItem('fountainJunkCount', junkCount);

                const junks = ['ğŸŸ', 'ğŸ‘', 'ğŸ¥«', 'ğŸ¦´', 'ğŸ’©', 'ğŸšï¸', 'ğŸ€'];
                item.innerText = junks[Math.floor(Math.random() * junks.length)];
                playSound(80, 'sawtooth', 0.5, 0.1); 
            } else {
                item.innerText = '$';
                playSound(900 + Math.random() * 300, 'sine', 0.3, 0.1);
            }

            const jumpDistance = (Math.random() - 0.5) * 300; 
            item.style.setProperty('--x', `${jumpDistance}px`);
            item.style.bottom = "100px"; 
            world.appendChild(item);

            setTimeout(() => {
                const splash = document.createElement('div');
                splash.className = 'splash';
                splash.style.left = `calc(50% + ${jumpDistance}px)`;
                world.appendChild(splash);
                playSound(150, 'triangle', 0.2, 0.2); 
                setTimeout(() => splash.remove(), 400);
            }, 600);

            setTimeout(() => { item.remove(); }, 800);
        }
    </script>
</body>
</html>
